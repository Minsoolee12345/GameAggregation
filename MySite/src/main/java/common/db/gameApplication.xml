<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.ac.kopo.dao.GameApplicationDAO">

    <!-- 게임 신청서 삽입 -->
    <insert id="insertGameApplication" parameterType="kr.ac.kopo.vo.GameApplicationVO">
        INSERT INTO t_game_applications (id, game_url, game_title, game_intro, status, created_date)
        VALUES (seq_game_applications_id.nextval, #{gameUrl}, #{gameTitle}, #{gameIntro}, 'pending', SYSDATE)
    </insert>

    <!-- 상태가 'pending'인 모든 게임 신청서 조회 -->
    <select id="getPendingApplications" resultType="kr.ac.kopo.vo.GameApplicationVO">
        SELECT id, game_url AS gameUrl, game_title AS gameTitle, game_intro AS gameIntro, status, created_date AS createdDate
        FROM t_game_applications
        WHERE status = 'pending'
        ORDER BY created_date DESC
    </select>

    <!-- 특정 게임 신청서 조회 by ID -->
    <select id="selectApplicationById" parameterType="int" resultType="kr.ac.kopo.vo.GameApplicationVO">
        SELECT id, game_url AS gameUrl, game_title AS gameTitle, game_intro AS gameIntro, status, created_date AS createdDate
        FROM t_game_applications
        WHERE id = #{id}
    </select>

    <!-- 게임 신청서 승인: 상태를 'approved'로 업데이트 -->
    <update id="updateApplicationStatus" parameterType="int">
        UPDATE t_game_applications
        SET status = 'approved'
        WHERE id = #{id}
    </update>

    <!-- 게임 신청서 거절: 상태를 'rejected'로 업데이트 -->
    <update id="rejectApplication" parameterType="int">
        UPDATE t_game_applications
        SET status = 'rejected'
        WHERE id = #{id}
    </update>

</mapper>
